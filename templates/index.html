<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pizza Expert Chat</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
    body {
        margin: 0;
        font-family: 'Roboto Mono', monospace;
        background: linear-gradient(135deg, #FFFAF0, #FFE5B4);
        color: #333;
    }

    .container {
        max-width: 650px;
        margin: 50px auto;
        background: #fff8f0;
        border-radius: 25px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .header {
        font-family: 'Pacifico', cursive;
        background: linear-gradient(90deg, #FF6347, #FFA07A);
        color: white;
        text-align: center;
        font-size: 2.8em;
        padding: 30px 15px;
        text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
    }

    .subheader {
        text-align: center;
        font-size: 1.1em;
        color: #fff;
        background: #FF8C00;
        padding: 10px 0;
        letter-spacing: 0.5px;
    }

    .chat-box {
        padding: 20px;
        height: 480px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 15px;
        background: #fff4e6;
        scroll-behavior: smooth;
    }

    .message {
        max-width: 80%;
        padding: 15px 20px;
        border-radius: 25px;
        line-height: 1.6;
        word-wrap: break-word;
        font-size: 1em;
        position: relative;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        opacity: 0;
        transform: translateY(10px);
        animation: fadeIn 0.35s forwards;
        font-family: 'Roboto Mono', monospace;
        transition: transform 0.2s ease;
    }

    @keyframes fadeIn {
        to { opacity: 1; transform: translateY(0); }
    }

    .message:hover {
        transform: scale(1.02);
    }

    .user {
        background: linear-gradient(135deg, #FFD1D1, #FFBABA);
        align-self: flex-end;
        color: #800000;
    }

    .bot {
        background: linear-gradient(135deg, #FFF4B2, #FFE07A);
        align-self: flex-start;
        color: #5a3e00;
    }

    .bot::before {
        content: "üçï";
        position: absolute;
        left: -30px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 1.6em;
    }

    .input-area {
        display: flex;
        border-top: 1px solid #ddd;
        background: #fff;
    }

    .input-area input {
        flex: 1;
        padding: 18px;
        border: none;
        outline: none;
        font-size: 1em;
        font-family: 'Roboto Mono', monospace;
    }

    .input-area button {
        background: linear-gradient(90deg, #FF6347, #FFA07A);
        border: none;
        color: white;
        padding: 0 25px;
        cursor: pointer;
        font-size: 1em;
        font-weight: bold;
        transition: all 0.3s ease;
    }

    .input-area button:hover {
        background: linear-gradient(90deg, #FF4500, #FF7F50);
        transform: scale(1.05);
    }

    .chat-box::-webkit-scrollbar {
        width: 10px;
    }

    .chat-box::-webkit-scrollbar-thumb {
        background: #FF6347;
        border-radius: 5px;
    }

    .chat-box::-webkit-scrollbar-track {
        background: #fff4e6;
        border-radius: 5px;
    }

</style>
</head>
<body>
<div class="container">
    <div class="header">Pizza Expert</div>
    <div class="subheader">Ask about our pizzas, toppings, or dietary options!</div>
    <div class="chat-box" id="chat-box">
        <!-- Messages appear here -->
    </div>
    <form class="input-area" id="chat-form">
        <input type="text" name="question" placeholder="Ask your pizza question..." required>
        <button type="submit">Send</button>
    </form>
</div>

<script>
    const form = document.getElementById('chat-form');
    const chatBox = document.getElementById('chat-box');

    function appendMessage(text, sender) {
        const msg = document.createElement('div');
        msg.className = `message ${sender}`;
        msg.innerText = text;
        chatBox.appendChild(msg);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const input = form.elements['question'];
        const question = input.value.trim();
        if (!question) return;

        appendMessage(question, 'user');
        input.value = '';

        // Bot typing placeholder
        const botMsg = document.createElement('div');
        botMsg.className = 'message bot';
        botMsg.innerText = 'üçï Thinking...';
        chatBox.appendChild(botMsg);
        chatBox.scrollTop = chatBox.scrollHeight;

        // Send request to Flask backend
        const formData = new FormData();
        formData.append('question', question);
        const res = await fetch('/ask', { method: 'POST', body: formData });
        const data = await res.json();

        botMsg.innerText = data.response || "Sorry, something went wrong.";
        chatBox.scrollTop = chatBox.scrollHeight;
    });
</script>
</body>
</html>
